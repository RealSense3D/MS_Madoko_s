<!DOCTYPE html>
<html>
<head>

<!-- 
  Copyright 2013 Microsoft Corporation.
 
  This is free software; you can redistribute it and/or modify it under the
  terms of the Apache License, Version 2.0. A copy of the License can be
  found in the file "license.txt" at the root of this distribution.
-->

<!-- Editor themes -->
<link rel="stylesheet" type="text/css" media="screen" href="lib/vs/editor/css/vs-dark-theme.css" />
<link rel="stylesheet" type="text/css" media="screen" href="lib/vs/editor/css/vs-theme.css" />

<!-- madoko style -->
<link rel="stylesheet" type="text/css" href="styles/madoko.css">

<!-- main style -->
<link rel="stylesheet" type="text/css" href="styles/main.css">

<!-- use the monaco loader to implement "require" -->
<script type="text/javascript" src="lib/vs/loader.js"></script>
<script>
  require.config({
    baseUrl: "lib"
  });
</script>

<!-- install a handler that calls madoko to typeset -->
<script>
require([ "../scripts/util",
          "../scripts/ui",
          "../scripts/runner",
          "vs/editor/editor.main"],
          function(util,UI,Runner) 
{ 
  var runner = new Runner();
  var ui     = new UI(runner);
  util.message("ready", util.Msg.Status );
});
</script>


</head>

<body>
<noscript>
<p>Madoko is a dynamic application that requires JavaScript.</p>
<p>Please enable JavaScript in your browser and reload.</p>
</noscript>
<div id="oldbrowser" style="display:none; padding: 1ex">
<p>Madoko uses HTML5 features and requires a recent browser version to work correctly.</p>
<p>Please upgrade your browser to a more recent version.</p>
<p>Madoko is known to work with IE 10+, Chrome version 31+, or Firefox version 27+.</p>
</div>
<div id="app" style="display:none">
<div class="toppane">

<!--
<img src="images/monarch-34px.png" id="logo"/>
insert image:
<input type="file" id="insertImages" name="files[]" title="Add images" accept="image/*"/>
-->
<!--<img id="logo" src="images/madoko-logo.svg"/>-->
<!-- <img id="logo" src="images/madoko-abslogo-xsmall.png"/> -->

</div>
<div id="editorpane" class="pane left">
  <div id="editor-header" class="pane-header">
    <div id="edit-select" class="popup boxed">
      <img id="remote-logo" src="images/cloud.svg" />
      <span id="edit-select-header">&nbsp;</span>
      <div id="edit-select-content" class="menu boxed">        
      </div>
    </div
    ><div id="document" class="popup"
      ><!--&nbsp;<span class="button boxed"><img class="icon" src="images/tri-down.svg"/></span>&nbsp;-->
      <img id="cloud" class="button" src="images/cloud.svg"/>
      <div id="document-content" class="menu boxed">
        <!--<div id="load-local" class="menu button" title="Load document from browser local storage"
          ><img src="images/local-logo.svg" class="logo" /> Load from local storage</div>-->
        <div id="load-onedrive" class="button" title="Load document from Onedrive cloud storage"
          ><span class="icon"><img src="images/onedrive-logo.png"/></span>Load from onedrive</div>
        <div id="load-dropbox" class="button disable" title="Load document from Dropbox cloud storage"
          ><span class="icon"><img src="images/dropbox-logo.png"/></span>Load from dropbox</div>
        <div id="new-document" class="button" title="Create a new local document"
          ><span class="icon"><span class="icon"><img src="images/madoko-icon-100.png"/></span></span>New local document</div>
        <hr/>
          <span>&nbsp;Save as:&nbsp;&nbsp;<input id="rename" class="header" value="" type="text"/></span>
        <!-- <div id="sync-local" class="menu button" title="Save workspace to browser local storage"
          ><img src="images/local-logo.svg" class="logo" /> To local storage</div> -->
        <div id="sync-onedrive" class="button" title="Save document to Onedrive cloud storage"
          ><span class="icon"><img src="images/onedrive-logo.png"/></span>To onedrive</div>
        <div id="sync-dropbox" class="button disable" title="Save document to Dropbox cloud storage"
          ><span class="icon"><img src="images/dropbox-logo.png"/></span>To dropbox</div>
      </div>
    </div>
    <div class="buttons">
      <span id="sync"><img id="sync-spinner" class="button spinner" src="images/sync.svg" alt="Synchronize" 
        title="Synchronize with cloud storage" /></span>    
      <div id="menu-settings" class="popup">
        <img class="button" src="images/settings.svg" />
        <div id="menu-settings-content" class="menu boxed">
          <div class="button" title="Synchronize every 10 seconds with cloud storage">
            <input type="checkbox" id="checkAutoSync"/> Synchronize automatically</div>
          <div class="button" title="Show line numbers in the editor">
            <input type="checkbox" id="checkLineNumbers"/> Show line numbers</div>
          <div class="button" title="Wrap lines in the editor">
            <input type="checkbox" id="checkWrapLines"/> Wrap lines</div>
         <hr/>
          <div class="button" 
               title="Do not update the view until there is a pause in typing.
This setting is turned on or off automatically depending on your browser performance.
Delaying the view update increases performance with large documents or slow browsers.">
            <input type="checkbox" id="checkDelayedUpdate"/> Delayed view update</div>
          <div class="button" 
               title="Do not update the view automatically.
This setting can save energy or can be used on very slow browsers to increase responsiveness.">
            <input type="checkbox" id="checkDisableAutoUpdate"/> Disable automatic view updates</div>
          <div class="button" 
               title="Do not use the Madoko server to typeset mathematics and/or the bibliography">
            <input type="checkbox" id="checkDisableServer"/> Disable server</div>         
         <hr/>
         <!--<div id="sync" class="button" title="Synchronize document"
            ><span class="icon"><img src="images/sync.svg"/></span>Synchronize</div>-->
          <div id="clear-local" class="button" title="Clears local browser storage.
Do not use unless instructed to do so :-)"
            ><span class="icon"></span>Clear local storage</div>
        </div>
      </div>
      
      <img id="button-editor-wide" class="button" title="Make the editor view wider" src="images/tri-right.svg" />
    </div>
  </div>
  <div class="pane-content boxed" >
    <div id="editor"></div>
  </div>
</div>
<div id="viewpane" class="pane right">
  <div id="view-header" class="pane-header">
    <div class="buttons">
      <img id="button-editor-narrow" class="button" title="Make the document view wider" src="images/tri-left.svg" />
      <div id="help" class="popup">
        <img class="button" src="images/help.svg" alt="Help"/>
        <div id="help-content" class="menu boxed">
          <div>The <a target="_blank" href="http://research.microsoft.com/en-us/um/people/daan/madoko/doc/reference.html"
                >reference manual</a> is a great place to start.
          </div>
          <div>Participate in a 
                <a target="_blank" href="http://madoko.codeplex.com/discussions">discussion</a> 
                or report an 
                <a target="_blank" href="http://madoko.codeplex.com/work/list/basic">issue</a>.
          </div>
          <hr/>
          <div class="notice"
          ><span id="version">Madoko, version 0.1-beta</span><br>
               Copyright &copy; 2014, Microsoft Corporation<br>
               Created at Microsoft Research by Daan Leijen.<br>
               Madoko is free software and available under the Apache 2.0 license
               on <a target="_blank" href="http://madoko.codeplex.com">codeplex.com</a>.
          </div>
        </div>
      </div>
      <img id="export-html" title="Export document as a web-page (HTML)"
        class="button" src="images/html-logo.png" alt="Download HTML"/>    
      <img id="export-pdf" title="Export document as PDF"
        class="button" src="images/pdf-logo2.png" alt="Download PDF"/>    
    </div>
    <img id="view-spinner" class="spinner" src="images/spinner-line.svg" alt="view spinner"/>    
    <div id="view-message" class="popup boxed">
      <img id="warning" class="hide" src="images/warn.svg"/>
      <span id="status"></span>
      <div id="koka-console" class="madoko menu boxed">
        <div id="koka-console-out" class="monospace short"></div>
      </div>
    </div>
  </div>
  <div class="pane-content boxed" id="view-container">
    <!-- <div id="view" class="madoko madoko-body"></div> -->
    <iframe id="view" class="view" sandbox="allow-scripts allow-popups" 
            src="https://madoko.cloudapp.net:8080/preview/preview.html"></iframe>
  </div>
</div>
</div>

<div id="iframe" style="display: none">
  <iframe id="download-frame" style="display: none"></iframe>
</div>

<div id="initial" style="display:none; white-space:pre">Title         : Welcome to Madoko
Heading Base  : 2
Author        : You
Email         : you@anywhere.com

[TITLE]

# Various Madoko features       {#sec-features}

Here is a famous equation:

~ Equation { #euler }
e = \lim_{n\to\infty} \left( 1 + \frac{1}{n} \right)^n
~

Let's define a list:

* And refer to Equation [#euler] in Section [#sec-features].
* Or search for [euler] instead?

```javascript 
function hi() {
  return "hello world";
}
```

[euler]: http://www.bing.com/search?q=euler "Bing Euler"
</div>

<script>
// test browser features
if (typeof Worker === "undefined") {
  document.getElementById("oldbrowser").style.display = "block";
}
else {
  document.getElementById("app").style.display = "block"; 
}
</script>


<!-- onedrive -->
<script src="//js.live.net/v5.0/wl.debug.js"></script> 

<script>
require([ "../scripts/storage" ], function(storage) 
{ 
  storage.onedriveInit({
    client_id   : "000000004C113E9D",
    redirect_uri: "https://madoko.cloudapp.net:8080/redirect", 
    scope       : ["wl.signin","wl.skydrive","wl.skydrive_update"],
  });
});
</script>

</body>
</html>

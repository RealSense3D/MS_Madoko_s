\documentclass{book}
% generated by Madoko, version 0.9.5-beta
%mdk-data-line={1}

\usepackage{option}


\begin{document}

\makeatletter


\optionset{%
  /fama/testa/.code={here is a: #1},
  /famb/testb/.code={here is b: #1},
  /fam/test/.style={/fama/testa=#1,/famb/testb=x#1x},
  /fam/.new family={/fama,/famb},
  /fama/toggle/.new toggle=true,
  /famb/border/side/.new choice={top,left,right,bottom},
  /fama/width/.new length=\fboxrule + 1pt,
  /famb/widthb/.new dimen={\fboxrule * 2 + 1pt}
}


\optionset{/fam,testb=testing}

\optionshowall


\end{document}



\newrobustcmd*\test[1]{%
  \option@splitkey{#1}%
}

\test{/fam/key}
\test{/key}
\test{key}
\test{/.ignore}
\test{/fam/sub/key}
\test{/fam/sub/key/.ignore}
\test{}
\test{/}
\test{foo/key}
\test{//key}
\test{//fam/key}
\test{//}
\test{///}
\test{////key}
\end{document}

\end{document}

\option@findinkeypath{/fbox}{.unknown}
\option@findinkeypath{/fbox/}{.unknown}
\option@findinkeypath{/fbox/foo}{.unknown}
\option@findinkeypath{/fbox/border}{.unknown}
\option@findinkeypath{/fbox/border/left}{.unknown}
\option@findinkeypath{/fbox/border/left/width}{.unknown}
\option@findinkeypath{/fbox/xborder/left}{.unknown}
\option@findinkeypath{/fbox/xborder/left/width}{.unknown}
\option@findinkeypath{/}{.unknown}
\option@findinkeypath{/foo}{.unknown}
%\option@findinkeypath{}{.unknown}
\option@findinkeypath{/fbox/border/left/}{.unknown}
\option@findinkeypath{/fbox/border/left//}{.unknown}



\end{document}

\option@splitroot{fooyes!}
\typeout{ split: "\option@root","\option@subpath"}

\iffalse
\newcount\@loop
\def\do#1#2#3{\letoption{#2#3/.searchalso}\opt@trykey\ifx\opt@trykey\relax\else\def\opt@found{found}\fi}%
\def\option@foreachparent#1{%
  \option@splitroot{#1}\do{\option@root}{\option@subpath}{}%
}
\def\opt@testforeach{%
  \option@foreachparent{/fbox/border/left/style}%
  \option@foreachparent{/fbox/border/left/style}%
  \option@foreachparent{/fbox/border/left/style}%
  \option@foreachparent{/fbox/border/left/style}%
  \option@foreachparent{/fbox/border/left/style}%
  \option@foreachparent{/fbox/border/left/style}%
  \option@foreachparent{/fbox/border/left/style}%
  \option@foreachparent{/fbox/border/left/style}%
  \option@foreachparent{/fbox/border/left/style}%
  \option@foreachparent{/fbox/border/left/style}%
  \option@foreachparent{/fbox/border/left/style}%
  \option@foreachparent{/fbox/border/left/style}%
  \advance\@loop 1\relax
}
\@whilenum\@loop<25000\do\opt@testforeach
\fi

\end{document}


\end{document}


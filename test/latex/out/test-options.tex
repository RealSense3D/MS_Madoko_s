\documentclass{book}
% generated by Madoko, version 0.9.5-beta
%mdk-data-line={1}

\usepackage{options}


\begin{document}

\section{Introduction}

\makeatletter

\def\famcmd{}

\optionset{%
  /fama/width/.new length   =5pt,
  /fama/sep/.new dim        =\fboxsep + \fboxrule,
  /famb/width/.new length   =1pt,
  /famc/widthc/.new length  =3pt,
  /fama/testa/.new value    =[]fifteen,
  /fam/cmd/.is def/.expands =\famcmd,
  /fam/counter/.is counter  =section,
  /fam/num/.new num         =[4]0,
  /fam/side/.new choice     =[top]{top,right,bottom,left},
  /fam/test/.new cmd        =[haha]\typeout{test received #1, \detokenize{#1}},
  /fam/.new family          =/fama,
  /fam/members/.new list    ={a,b,c},
}

\optionset{%
  /fama/width=\fboxsep + \fboxrule,
  /fam/sep=12pt,
  /fam,
  testa,
  side=right,
  cmd=hi,
  test=\option{/fama/testa},
  test/.expand once=\option{/fama/testa},
  test/.expand twice=\option{/fama/testa},
  test/.expanded=\option{/fama/testa},
  test,
  members/.expand twice/.push=\option{/fam/cmd},
  /fam/num,
  /fam/num/.inc=4,
  /fam/counter/.step/.step,
  side,
}

\ifcase\option{/fam/side/@ord}
  the top
\or
  the right
\or
  other
\fi

\if\option{/fam/side/@tag}r\relax
  it's right
\else
  or not
\fi


\optionshowall



\end{document}


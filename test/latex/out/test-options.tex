\documentclass{book}
% generated by Madoko, version 0.9.5-beta
%mdk-data-line={1}

\usepackage{options}


\begin{document}

\section{Introduction}

\makeatletter


\def\unmatch$#1${\textsf{#1}}
\options{
  /"/.new special = special1 #1.,
  /(/.new special = special2 #1.,
  /</.new special = special3 #1.,
%  /$/.new special = special4 \unmatch#1.,
}

\options{"red",(red),<red>}


\def\famcmd{}

\options{/fam/.new family}

\options{/fam/testii/.new cmd 2 = {option a: #1, b: #2\\}}

\options{/fam/testii={x} {y}, /fam/testii=xy, /fam/testii={x}, /fam/testii= }

\options{/fam/testx/.new cmdx ={#1,#2,#3}{,,}{option #1*#2*#3\\}}
\options{/fam/testx=x,/fam/testx={x,y},/fam/testx={x,y,z}}

\options{/fam/test2/.new cmd tuple =[{1,2}]{tuple: (#1,#2)}}
\options{/fam, test2={x,y}, test2}

\options{/fam/test3/.new cmd triple = {triple: (#1,#2,#3)}}
\options{/fam, test3={x,y,z}}

\options{%
  /fama/width/.new length   =5pt,
  /fama/sep/.new dim        =\fboxsep + \fboxrule,
  /famb/width/.new length   =1pt,
  /famc/widthc/.new dim  =3pt,
  /fama/testa/.new value    =[]fifteen,
  /fam/cmd/.is def =\famcmd,
  /fam/counter/.is counter  =section,
  /fam/num/.new num         =[4]0,
  /fam/side/.new choice     ={top,right,bottom,left},
  /fam/test/.new cmd        =[haha]\typeout{test received #1, \detokenize{#1}},
  /fam/.search also          =/fama,
  /fam/members/.new list    ={a,b,c},
  /famc/.new family,
  /fama/.new family
}

\options*{/fam,/fama/width=6pt,widthc=5pt,widthc=5pt+3pt}


\letoptionlist{/options/remaining}\remaining
\typeout{test: \meaning\remaining}
remaining: \expandnext\detokenize{\remaining}

\optionswithremaining*{/famc,num=5}
remaining: \optionshow{/options/remaining}
\optionswithremaining{/fam}

\options{%
  /fama/width=\fboxsep + \fboxrule,
  /fam/sep=12pt,
  /fam,
  side=right,
  cmd=hi,
  test=\option{/fama/testa},
  test/.expand once=\option{/fama/testa},
  test/.expand twice=\option{/fama/testa},
  test/.expanded=\option{/fama/testa},
  test,
  members/.expand twice/.push=\option{/fam/cmd},
  /fam/num,
  /fam/num/.inc=4,
  /fam/counter/.step/.step,
}

\ifcase\option{/fam/side/@ord}
  the top
\or
  the right
\or
  other
\fi

\if\option{/fam/side/@tag}r\relax
  it's right
\else
  or not
\fi


\optionshowall



\end{document}


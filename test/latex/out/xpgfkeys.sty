\documentclass{book}
% generated by Madoko, version 0.9.5-beta
%mdk-data-line={1}

\usepackage{etoolbox}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{pgfkeys}
\usepackage{enumitem}

\makeatletter
% --------------------------------------------------------
% Extensions to etoolbox
% --------------------------------------------------------

\providerobustcmd*\@swaparg[2]{#2{#1}}
\providerobustcmd*\expandnext[2]{\expandafter\@swaparg\expandafter{#2}{#1}}

\providecommand\eifstrequal[1]{%
  \expandnext\ifstrequal{#1}%
}

\providecommand\eifblank[1]{%
  \expandnext\ifblank{#1}%
}

\providecommand\ontoggle[2]{%
  \iftoggle{#1}{#2}{}%
}

\providecommand\providelength[1]{% 
  \ifdef{#1}{}{\newlength#1}%
}

\providecommand\csnewlength[1]{%
  \expandafter\newlength\csname #1\endcsname%
}
\providecommand\csprovidelength[1]{%
  \ifcsdef{#1}{}{\expandafter\newlength\csname #1\endcsname}%
}
\providecommand\cssetlength[2]{%
  \expandafter\setlength\csname #1\endcsname{#2}%
}

% --------------------------------------------------------
% 
% --------------------------------------------------------

\newcommand*\valueof{}
\let\valueof\pgfkeysvalueof
\newcommand*\letvalueof{}
\let\letvalueof\pgfkeysgetvalue
\newrobustcmd*\edefvalueof[2]{\letvalueof{#1}#2\protected@edef#2{#2}}

\providecommand\pgfkeysifblank[1]{%
  \edefvalueof{#1}\xpk@temp%
  \expandafter\ifblank\expandafter{\xpk@temp}%
}

\providecommand\pgfkeysifvoid[1]{%
  \pgfkeysifblank{#1}%
}

% --------------------------------------------------------
% 
% --------------------------------------------------------

\newrobustcmd*\xpk@registerkey[1]{%
  \edef\pgfkeyscurrentkey{#1}%
  \xpk@registerkey@{/.@names}%
}
\newrobustcmd*\xpk@registerkey@[1]{%
  \eifblank{\pgfkeyscurrentkey}{}{%
    \pgfkeys@split@path
    \edef\xpk@path{\pgfkeyscurrentpath}%
    \edef\xpk@name{\pgfkeyscurrentname}%
    \edef\xpk@tempname{/@meta/keys\xpk@path}
    \pgfkeysifdefined{\xpk@tempname/.@names}{}{%
      \pgfkeyssetvalue{\xpk@tempname/.@names}{}%
      \pgfkeyssetvalue{\xpk@tempname/.@paths}{}%
    }%
    \edef\xpk@tempname{\xpk@tempname#1}%
    \expandnext{\pgfkeysaddvalue{\xpk@tempname}{}}{\xpk@name,}%
    \typeout{register: \xpk@tempname=\valueof{\xpk@tempname} + \xpk@name}%
    \let\pgfkeyscurrentkey\xpk@path%
    \xpk@registerkey@{/.@paths}%
  }%
}



% --------------------------------------------------------
% Show definitions
% --------------------------------------------------------

\newrobustcmd*\xpkshowall[1][]{%
  \xpkshowpath{#1}%
}

\newrobustcmd*\xpk@showname[1]{%
  \textsf{#1}%
}
\newrobustcmd*\xpk@showpathname[1]{%
  \textsf{#1}%
}

\newrobustcmd*\xpkshowpath[2][]{%  
  \noindent\xpk@showpathname{#2/}%
  \typeout{showpath: #1,#2}%
  \pgfkeysifvoid{/@meta/keys#1#2/.@names}{}{\xpkshownames{#1#2}{#1#2/.@names}}%
  \pgfkeysifvoid{/@meta/keys#1#2/.@paths}{}{\typeout{show paths...}\xpkshowpaths{#1#2}{#1#2/.@paths}}%
  \typeout{ showpath: #1,#2,done}%
}

\newrobustcmd*\xpkshowpaths[3][]{%
  \typeout{show paths: #1,#2,#3}%
  \begin{itemize}[noitemsep,topsep=0pt,leftmargin=1em,label=,#1]
  \def\do##1{%
    \item\xpkshowpath[#2/]{##1}%
    \typeout{shown path ##1}
  }%
  \edefvalueof{/@meta/keys#3}\xpk@paths
  \typeout{ paths: "\xpk@paths"}%
  \expandnext\docsvlist{\xpk@paths}%
  \end{itemize}
}

\newrobustcmd*\xpkshownames[3][]{%
  \typeout{show names #1,#2,#3}%
  \begin{itemize}[noitemsep,topsep=0pt,leftmargin=1em,label=,#1]
  \def\do##1{%  
    \xpkshowname{#2/##1}{##1}%
  }%
  \edefvalueof{/@meta/keys#3}\xpk@names
  \expandnext\docsvlist{\xpk@names}%
  \typeout{end itemize}%
  \end{itemize}
  \typeout{end itemize done}%
}


\newrobustcmd*\xpkshowname[2]{%
  \typeout{show name: #1,#2}%
  \item\xpk@showname{#2}%
  \pgfkeysifdefined{#1/.show}%
    {\letvalueof{#1/.show}\opt@showit}%
    {\def\opt@showit##1{##1}}%
  \def\opt@show##1{\textsf{\opt@showit{##1}}}%
  \expandafter\ifdefparam\expandafter{\csname pgfk@#1\endcsname}%
    {=\textit{cmd}}%
    {=\opt@show{\valueof{#1}}}%  
  \pgfkeysifdefined{#1/.@initial}{%
    , initial=\opt@show{\valueof{#1/.@initial}}%
  }{}%
  \pgfkeysifdefined{#1/.@def}{%
    , default=\opt@show{\valueof{#1/.@def}}%
  }{}%
  \typeout{show name done}
}


% --------------------------------------------------------
% 
% --------------------------------------------------------

\newrobustcmd*\xpk@initdefault{\@ifnextchar[{\xpk@initdefault@def}{\xpk@initdefault@init}}
\def\xpk@initdefault@def[#1]{%
  \pgfkeysalso{\pgfkeyscurrentpath/.default=#1}%
  \typeout{set default \pgfkeyscurrentpath=#1=\valueof{\pgfkeyscurrentpath/.@def}}%
  \xpk@initdefault@init
}
\def\xpk@initdefault@init#1\relax{%
  \pgfkeysalso{\pgfkeyscurrentpath/.initial=#1}%
}

\pgfkeys{/handlers/.new length/.code=%
  \edef\xpk@name{length@\pgfkeyscurrentpath}%
  \csnewlength{\xpk@name}%
  \expandnext{\pgfkeyssetvalue{\pgfkeyscurrentpath}}{\csuse{\xpk@name}}%
  \pgfkeysalso{%
    \pgfkeyscurrentpath/.ecode=\noexpand\cssetlength{\xpk@name}{\noexpand\dimexpr##1\noexpand\relax}%
  }%
  \xpk@initdefault#1\relax%
  \xpk@registerkey{\pgfkeyscurrentpath}%
}



\begin{document}

\pgfkeys{%
  /fama/width/.new length={1pt},
  /famb/width/.new length=[4pt]1pt,
  width/.new length=1pt,
}

\xpkshowall

\end{document}

